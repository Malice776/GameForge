{% extends 'base.html' %}

{% block title %}Connexion - GameForge{% endblock %}

{% block extra_css %}
<style>
    @keyframes floatIn {
        from {
            opacity: 0;
            transform: translateY(30px) scale(0.95);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    @keyframes shimmerGlow {
        0%, 100% {
            box-shadow:
                0 0 20px rgba(212, 175, 55, 0.3),
                0 10px 40px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(212, 175, 55, 0.2);
        }
        50% {
            box-shadow:
                0 0 30px rgba(212, 175, 55, 0.5),
                0 15px 50px rgba(0, 0, 0, 0.6),
                inset 0 1px 0 rgba(212, 175, 55, 0.3);
        }
    }

    @keyframes runicPulse {
        0%, 100% {
            opacity: 0.6;
            text-shadow: 0 0 10px var(--secondary-color);
        }
        50% {
            opacity: 1;
            text-shadow: 0 0 20px var(--secondary-color), 0 0 30px var(--accent-color);
        }
    }

    .login-container {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 100px 20px 50px;
        position: relative;
        overflow: hidden;
    }

    .login-container::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background:
            radial-gradient(circle at 30% 50%, rgba(139, 69, 19, 0.2) 0%, transparent 50%),
            radial-gradient(circle at 70% 50%, rgba(155, 89, 182, 0.2) 0%, transparent 50%);
        animation: rotate 30s linear infinite;
        pointer-events: none;
    }

    @keyframes rotate {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .login-card {
        background:
            linear-gradient(145deg, rgba(26, 15, 10, 0.95), rgba(13, 7, 5, 0.98)),
            url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text x="20" y="50" font-family="serif" font-size="40" fill="rgba(212,175,55,0.03)" transform="rotate(-15 50 50)">⚔</text></svg>');
        border: 3px solid var(--copper);
        border-radius: 15px;
        box-shadow:
            0 20px 60px rgba(0, 0, 0, 0.8),
            0 0 0 1px rgba(212, 175, 55, 0.1) inset,
            0 0 40px rgba(212, 175, 55, 0.2);
        position: relative;
        overflow: hidden;
        animation: floatIn 0.8s ease-out, shimmerGlow 3s ease-in-out infinite;
        max-width: 500px;
        width: 100%;
    }

    .login-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.1), transparent);
        animation: slideShimmer 3s ease-in-out infinite;
    }

    @keyframes slideShimmer {
        0% { left: -100%; }
        50%, 100% { left: 100%; }
    }

    .login-card::after {
        content: '⚔';
        position: absolute;
        font-size: 150px;
        color: rgba(212, 175, 55, 0.05);
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) rotate(-15deg);
        pointer-events: none;
        z-index: 0;
    }

    .card-body {
        position: relative;
        z-index: 1;
    }

    .login-header {
        text-align: center;
        margin-bottom: 2rem;
        position: relative;
    }

    .login-icon {
        font-size: 4rem;
        color: var(--secondary-color);
        margin-bottom: 1rem;
        display: inline-block;
        animation: runicPulse 2s ease-in-out infinite;
        filter: drop-shadow(0 0 10px var(--secondary-color));
    }

    .login-title {
        font-family: 'Cinzel Decorative', serif;
        font-size: 2.5rem;
        color: var(--secondary-color);
        text-transform: uppercase;
        letter-spacing: 3px;
        margin-bottom: 0.5rem;
        text-shadow:
            2px 2px 4px rgba(0, 0, 0, 0.8),
            0 0 20px rgba(212, 175, 55, 0.5);
        position: relative;
    }

    .login-title::before,
    .login-title::after {
        content: '◆';
        position: absolute;
        color: var(--copper);
        font-size: 1rem;
        animation: runicPulse 2s ease-in-out infinite;
    }

    .login-title::before { left: -30px; top: 50%; transform: translateY(-50%); }
    .login-title::after { right: -30px; top: 50%; transform: translateY(-50%); }

    .login-subtitle {
        font-family: 'Cinzel', serif;
        color: var(--parchment);
        opacity: 0.9;
        font-style: italic;
        font-size: 1.1rem;
    }

    .form-group {
        margin-bottom: 1.5rem;
        position: relative;
    }

    .form-label {
        font-family: 'Cinzel', serif;
        color: var(--secondary-color);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
    }

    .form-label i {
        margin-right: 8px;
        filter: drop-shadow(0 0 3px currentColor);
    }

    input[type="text"],
    input[type="password"],
    input[type="email"] {
        background: rgba(245, 222, 179, 0.08);
        border: 2px solid var(--copper);
        color: var(--text-light);
        border-radius: 8px;
        padding: 12px 15px;
        font-family: 'Cinzel', serif;
        font-size: 1rem;
        transition: all 0.3s ease;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        width: 100%;
    }

    input[type="text"]:focus,
    input[type="password"]:focus,
    input[type="email"]:focus {
        background: rgba(245, 222, 179, 0.12);
        border-color: var(--secondary-color);
        color: var(--text-light);
        box-shadow:
            0 0 0 0.2rem rgba(212, 175, 55, 0.25),
            0 0 15px rgba(212, 175, 55, 0.5),
            inset 0 2px 4px rgba(0, 0, 0, 0.3);
        outline: none;
    }

    input[type="text"]::placeholder ,
    input[type="password"]::placeholder ,
    input[type="email"]::placeholder {
        color: rgba(244, 232, 216, 0.4);
        font-style: italic;
    }

    .btn-login {
        background: linear-gradient(135deg, var(--primary-color), var(--copper), var(--secondary-color));
        background-size: 200% 100%;
        border: 2px solid var(--secondary-color);
        color: var(--text-light);
        padding: 15px;
        font-family: 'Cinzel', serif;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 2px;
        font-size: 1.1rem;
        border-radius: 8px;
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
        box-shadow:
            0 6px 20px rgba(0, 0, 0, 0.5),
            inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }

    .btn-login::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s ease;
    }

    .btn-login:hover {
        background-position: 100% 0;
        transform: translateY(-2px);
        box-shadow:
            0 8px 25px rgba(212, 175, 55, 0.4),
            0 0 30px rgba(212, 175, 55, 0.3),
            inset 0 1px 0 rgba(255, 255, 255, 0.3);
        border-color: var(--secondary-color);
    }

    .btn-login:hover::before {
        left: 100%;
    }

    .btn-login:active {
        transform: translateY(0);
    }

    .divider {
        text-align: center;
        margin: 2rem 0;
        position: relative;
    }

    .divider::before,
    .divider::after {
        content: '';
        position: absolute;
        top: 50%;
        width: 40%;
        height: 1px;
        background: linear-gradient(to right, transparent, var(--copper), transparent);
    }

    .divider::before { left: 0; }
    .divider::after { right: 0; }

    .divider-text {
        display: inline-block;
        padding: 0 1rem;
        color: var(--parchment);
        font-family: 'Cinzel', serif;
        font-size: 0.9rem;
        background: rgba(26, 15, 10, 0.8);
    }

    .link-secondary {
        color: var(--parchment);
        text-decoration: none;
        font-family: 'Cinzel', serif;
        transition: all 0.3s ease;
        display: inline-block;
        position: relative;
    }

    .link-secondary::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 0;
        height: 1px;
        background: var(--secondary-color);
        transition: width 0.3s ease;
    }

    .link-secondary:hover {
        color: var(--secondary-color);
        text-shadow: 0 0 8px rgba(212, 175, 55, 0.5);
    }

    .link-secondary:hover::after {
        width: 100%;
    }

    .alert-danger {
        background: linear-gradient(135deg, rgba(220, 53, 69, 0.2), rgba(139, 0, 0, 0.2));
        border: 2px solid #dc3545;
        color: #ff6b6b;
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 1rem;
        font-family: 'Cinzel', serif;
        box-shadow: 0 4px 10px rgba(220, 53, 69, 0.3);
    }

    .text-danger {
        color: #ff6b6b !important;
        font-size: 0.85rem;
        font-style: italic;
    }

    @media (max-width: 576px) {
        .login-title {
            font-size: 1.8rem;
        }

        .login-title::before,
        .login-title::after {
            display: none;
        }

        .login-icon {
            font-size: 3rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="login-container">
    <div class="login-card">
        <div class="card-body p-5">
            <div class="login-header">
                <div class="login-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <h1 class="login-title">Connexion</h1>
                <p class="login-subtitle">Entrez dans votre forge créative</p>
            </div>

            <form method="post">
                {% csrf_token %}

                <div class="form-group">
                    <label for="{{ form.username.id_for_label }}" class="form-label">
                        <i class="fas fa-user"></i>Nom d'utilisateur
                    </label>
                    {{ form.username }}
                    {% if form.username.errors %}
                        <div class="text-danger mt-2">
                            {% for error in form.username.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <div class="form-group">
                    <label for="{{ form.password.id_for_label }}" class="form-label">
                        <i class="fas fa-key"></i>Mot de passe
                    </label>
                    {{ form.password }}
                    {% if form.password.errors %}
                        <div class="text-danger mt-2">
                            {% for error in form.password.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                {% if form.non_field_errors %}
                    <div class="alert alert-danger">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        {% for error in form.non_field_errors %}
                            {{ error }}
                        {% endfor %}
                    </div>
                {% endif %}

                <button type="submit" class="btn btn-login w-100 mb-3">
                    <i class="fas fa-door-open me-2"></i>Entrer dans la forge
                </button>

                <div class="text-center mb-3">
                    <a href="{% url 'password_reset' %}" class="link-secondary">
                        <i class="fas fa-question-circle me-1"></i>Mot de passe oublié ?
                    </a>
                </div>

                <div class="divider">
                    <span class="divider-text">⚔</span>
                </div>

                <div class="text-center">
                    <p class="text-muted mb-2" style="font-family: 'Cinzel', serif;">
                        Nouveau forgeron ?
                    </p>
                    <a href="{% url 'signup' %}" class="link-secondary" style="font-size: 1.1rem; font-weight: 600;">
                        <i class="fas fa-scroll me-2"></i>Créer un compte
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}